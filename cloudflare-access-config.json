{
  "cloudflare_access_configuration": {
    "application": {
      "name": "Portfolio App",
      "type": "Self-hosted",
      "domain": "rcormier.dev",
      "session_duration": "24h",
      "application_launcher": true
    },
    "identity_providers": [
      {
        "name": "iCloud PIN Auth",
        "type": "One-time PIN",
        "email_domain": "rcormier.dev",
        "pin_length": 6,
        "pin_expiration": "10m",
        "email_attribute": "email",
        "name_attribute": "name"
      }
    ],
    "policies": [
      {
        "name": "Public Access",
        "action": "Bypass",
        "priority": 1,
        "includes": [
          "rcormier.dev/",
          "rcormier.dev/strategy",
          "rcormier.dev/leadership", 
          "rcormier.dev/devops",
          "rcormier.dev/saas",
          "rcormier.dev/talent",
          "rcormier.dev/analytics",
          "rcormier.dev/project-analysis"
        ],
        "description": "Allow public access to main portfolio pages"
      },
      {
        "name": "Protected Page Access",
        "action": "Allow",
        "priority": 2,
        "includes": [
          "rcormier.dev/protected"
        ],
        "additional_rules": {
          "email": "roger@rcormier.dev"
        },
        "identity_provider": "iCloud PIN Auth",
        "description": "Require OTP authentication for protected content"
      },
      {
        "name": "HealthBridge Access",
        "action": "Allow", 
        "priority": 3,
        "includes": [
          "rcormier.dev/healthbridge-analysis"
        ],
        "additional_rules": {
          "email": "roger@rcormier.dev"
        },
        "identity_provider": "iCloud PIN Auth",
        "description": "Require OTP authentication for HealthBridge analysis"
      }
    ],
    "settings": {
      "session_duration": "24h",
      "idle_session_timeout": "8h",
      "session_timeout_warning": "5m",
      "device_posture": "none",
      "network_policies": "none"
    },
    "customization": {
      "login_page": {
        "custom_logo": "optional",
        "primary_color": "#0d9488",
        "company_name": "Roger Lee Cormier Portfolio"
      },
      "app_launcher": {
        "enabled": true,
        "custom_logo": "optional"
      }
    }
  },
  "setup_instructions": {
    "step_1": "Enable Cloudflare Zero Trust in your dashboard",
    "step_2": "Create One-Time PIN identity provider with rcormier.dev domain",
    "step_3": "Create Self-hosted application for rcormier.dev",
    "step_4": "Add policies in order: Public Access (Bypass) first, then Protected routes (Allow)",
    "step_5": "Test public pages work without authentication",
    "step_6": "Test protected pages require OTP authentication"
  },
  "testing_checklist": {
    "public_pages": [
      "rcormier.dev/",
      "rcormier.dev/strategy", 
      "rcormier.dev/leadership",
      "rcormier.dev/devops",
      "rcormier.dev/saas",
      "rcormier.dev/talent",
      "rcormier.dev/analytics",
      "rcormier.dev/project-analysis"
    ],
    "protected_pages": [
      "rcormier.dev/protected",
      "rcormier.dev/healthbridge-analysis"
    ],
    "expected_behavior": {
      "public_pages": "Accessible without authentication",
      "protected_pages": "Redirect to OTP login, require roger@rcormier.dev email"
    }
  },
  "troubleshooting": {
    "main_site_blocked": "Check if policies include rcormier.dev/* instead of specific routes",
    "authentication_loop": "Verify policy order and identity provider configuration",
    "otp_not_received": "Check spam folder and verify email domain configuration",
    "access_denied": "Verify email is set to roger@rcormier.dev in policy rules"
  }
}
